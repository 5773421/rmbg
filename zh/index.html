<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RMBG - 免费 AI 抠图工具 | 在线去背景，100% 隐私保护</title>
    <meta name="description" content="RMBG - 完全在浏览器本地运行的免费 AI 抠图工具。一键去除图片背景，无需上传，无服务器，无数据收集。您的图片永远不会离开设备。">
    <meta name="keywords" content="抠图, AI抠图, 去背景, 在线抠图, 免费抠图, 图片去背景, 证件照抠图, 电商抠图, 一键抠图, 智能抠图, background remover, remove bg">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="RMBG - 免费 AI 抠图工具">
    <meta property="og:description" content="免费在线 AI 抠图，100% 隐私保护，图片不出端。">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="RMBG - 免费 AI 抠图工具">
    <meta name="twitter:description" content="免费在线 AI 抠图，完全在浏览器本地运行，100% 隐私保护。">
    <link rel="canonical" href="https://rmbg.dev/zh/">
    <link rel="alternate" hreflang="en" href="https://rmbg.dev/">
    <link rel="alternate" hreflang="zh" href="https://rmbg.dev/zh/">
    <link rel="alternate" hreflang="x-default" href="https://rmbg.dev/">
    <script defer data-domain="rmbg.dev" src="https://click.pageview.click/js/script.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-tertiary: #1a1a1a;
            --text-primary: #fafafa;
            --text-secondary: #a1a1a1;
            --text-muted: #666666;
            --accent-green: #00ff88;
            --accent-green-dim: #00cc6a;
            --accent-cyan: #00d4ff;
            --border-color: #2a2a2a;
            --border-hover: #3a3a3a;
            --danger: #ff4444;
            --warning: #ffaa00;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .mono {
            font-family: 'Space Mono', monospace;
        }

        /* Noise texture overlay */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            z-index: 1000;
        }

        /* Grid background */
        .grid-bg {
            background-image:
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 60px 60px;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-family: 'Space Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            text-decoration: none;
            letter-spacing: -0.02em;
        }

        .logo span {
            color: var(--accent-green);
        }

        .nav-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.4rem 0.8rem;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 100px;
            font-size: 0.75rem;
            color: var(--accent-green);
            font-family: 'Space Mono', monospace;
        }

        .nav-badge::before {
            content: '';
            width: 6px;
            height: 6px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .lang-switch {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.4rem 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.75rem;
            font-family: 'Space Mono', monospace;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .lang-switch:hover {
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .lang-switch svg {
            opacity: 0.7;
        }

        /* Hero Section */
        .hero {
            min-height: 70vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 8rem 2rem 4rem;
            position: relative;
        }

        .hero-label {
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 100px;
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-family: 'Space Mono', monospace;
        }

        .hero-label svg {
            width: 16px;
            height: 16px;
            color: var(--accent-green);
        }

        .hero h1 {
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 1.5rem;
            letter-spacing: -0.03em;
        }

        .hero h1 .gradient {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-cyan) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-description {
            font-size: 1.25rem;
            color: var(--text-secondary);
            max-width: 600px;
            margin-bottom: 3rem;
        }

        .hero-features {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 3rem;
        }

        .feature-tag {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .feature-tag svg {
            width: 16px;
            height: 16px;
            color: var(--accent-green);
        }

        /* Main Tool Section */
        .tool-section {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .tool-container {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            overflow: hidden;
        }

        .tool-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-tertiary);
        }

        .tool-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-family: 'Space Mono', monospace;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .tool-title svg {
            width: 18px;
            height: 18px;
            color: var(--accent-green);
        }

        .model-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .model-badge {
            padding: 0.4rem 0.8rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.75rem;
            color: var(--text-muted);
            font-family: 'Space Mono', monospace;
        }

        .backend-badge {
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-family: 'Space Mono', monospace;
        }

        .backend-badge.webgpu {
            background: rgba(0, 255, 136, 0.15);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: var(--accent-green);
        }

        .backend-badge.wasm {
            background: rgba(255, 170, 0, 0.15);
            border: 1px solid rgba(255, 170, 0, 0.3);
            color: var(--warning);
        }

        .tool-body {
            padding: 2rem;
        }

        /* Model Loading State */
        .model-loader {
            text-align: center;
            padding: 4rem 2rem;
        }

        .model-loader-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 2rem;
            position: relative;
        }

        .model-loader-icon::before {
            content: '';
            position: absolute;
            inset: 0;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .model-loader-icon svg {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 32px;
            height: 32px;
            color: var(--accent-green);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .model-loader h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .model-loader p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1.5rem;
        }

        .progress-bar {
            width: 100%;
            max-width: 400px;
            height: 4px;
            background: var(--bg-tertiary);
            border-radius: 100px;
            margin: 0 auto 1rem;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-cyan));
            border-radius: 100px;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-family: 'Space Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Privacy Consent Modal */
        .consent-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
            padding: 2rem;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        .consent-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .consent-modal {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            max-width: 520px;
            width: 100%;
            overflow: hidden;
            transform: translateY(0);
            transition: transform 0.3s ease;
        }

        .consent-overlay.hidden .consent-modal {
            transform: translateY(20px);
        }

        .consent-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .consent-header-icon {
            width: 48px;
            height: 48px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .consent-header-icon svg {
            width: 24px;
            height: 24px;
            color: var(--accent-green);
        }

        .consent-header-text h3 {
            font-size: 1.125rem;
            margin-bottom: 0.25rem;
        }

        .consent-header-text p {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .consent-body {
            padding: 1.5rem;
        }

        .consent-feature {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg-tertiary);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .consent-feature:last-child {
            margin-bottom: 0;
        }

        .consent-feature-icon {
            width: 40px;
            height: 40px;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .consent-feature-icon svg {
            width: 20px;
            height: 20px;
            color: var(--accent-green);
        }

        .consent-feature h4 {
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }

        .consent-feature p {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .consent-footer {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .btn-primary {
            width: 100%;
            padding: 1rem 1.5rem;
            background: var(--accent-green);
            color: var(--bg-primary);
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .btn-primary svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .btn-primary:hover {
            background: var(--accent-green-dim);
            transform: translateY(-1px);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .consent-note {
            font-size: 0.75rem;
            color: var(--text-muted);
            text-align: center;
        }

        /* Upload Area */
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 4rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .upload-area:hover,
        .upload-area.dragover {
            border-color: var(--accent-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .upload-area.dragover {
            transform: scale(1.01);
        }

        .upload-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 1.5rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .upload-icon svg {
            width: 28px;
            height: 28px;
            color: var(--text-secondary);
        }

        .upload-area h3 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .upload-area p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .upload-hint {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .file-input {
            display: none;
        }

        /* Processing Area */
        .processing-area {
            display: none;
        }

        .processing-area.active {
            display: block;
        }

        .image-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .image-grid {
                grid-template-columns: 1fr;
            }
        }

        .image-panel {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
        }

        .image-panel-header {
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .image-panel-title {
            font-size: 0.875rem;
            font-family: 'Space Mono', monospace;
            color: var(--text-secondary);
        }

        .image-panel-body {
            padding: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            position: relative;
        }

        .image-panel-body img {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 4px;
        }

        /* Checkerboard background for transparency */
        .checkerboard {
            background-image:
                linear-gradient(45deg, #1a1a1a 25%, transparent 25%),
                linear-gradient(-45deg, #1a1a1a 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, #1a1a1a 75%),
                linear-gradient(-45deg, transparent 75%, #1a1a1a 75%);
            background-size: 16px 16px;
            background-position: 0 0, 0 8px, 8px -8px, -8px 0px;
            background-color: #252525;
        }

        .processing-spinner {
            position: absolute;
            inset: 0;
            background: rgba(17, 17, 17, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .processing-spinner.hidden {
            display: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 2px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        .processing-spinner p {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* Actions Bar */
        .actions-bar {
            margin-top: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .actions-left {
            display: flex;
            gap: 0.75rem;
        }

        .actions-right {
            display: flex;
            gap: 0.75rem;
        }

        .btn {
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            border: 1px solid transparent;
        }

        .btn svg {
            width: 16px;
            height: 16px;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-color: var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
            border-color: var(--border-hover);
        }

        .btn-success {
            background: var(--accent-green);
            color: var(--bg-primary);
        }

        .btn-success:hover {
            background: var(--accent-green-dim);
        }

        .btn-success:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Batch Upload */
        .batch-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .batch-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .batch-title {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-family: 'Space Mono', monospace;
        }

        .batch-actions {
            display: flex;
            gap: 0.5rem;
        }

        .batch-queue {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
        }

        .batch-item {
            position: relative;
            aspect-ratio: 1;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        .batch-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .batch-item-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .batch-item-overlay.done {
            background: rgba(0, 255, 136, 0.2);
        }

        .batch-item-overlay svg {
            width: 24px;
            height: 24px;
            color: var(--accent-green);
        }

        .batch-item-remove {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 24px;
            height: 24px;
            background: rgba(0, 0, 0, 0.7);
            border: none;
            border-radius: 4px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .batch-item:hover .batch-item-remove {
            opacity: 1;
        }

        .batch-item-remove:hover {
            color: var(--danger);
        }

        /* Stats Section */
        .stats-section {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .stat-card {
            padding: 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Space Mono', monospace;
            color: var(--accent-green);
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* Features Section */
        .features-section {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-header h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .section-header p {
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        @media (max-width: 900px) {
            .features-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .features-grid {
                grid-template-columns: 1fr;
            }
        }

        .feature-card {
            padding: 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            transition: all 0.2s ease;
        }

        .feature-card:hover {
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }

        .feature-card-icon {
            width: 48px;
            height: 48px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .feature-card-icon svg {
            width: 24px;
            height: 24px;
            color: var(--accent-green);
        }

        .feature-card h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }

        .feature-card p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Why Choose Section */
        .why-section {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .why-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        .why-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            transition: all 0.2s ease;
        }

        .why-card:hover {
            border-color: var(--border-hover);
        }

        .why-card-large {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.05) 0%, rgba(0, 212, 255, 0.05) 100%);
            border-color: rgba(0, 255, 136, 0.2);
        }

        .why-card-content {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .why-icon {
            width: 48px;
            height: 48px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .why-icon svg {
            width: 24px;
            height: 24px;
            color: var(--accent-green);
        }

        .why-card h3 {
            font-size: 1.125rem;
            margin: 0;
        }

        .why-card p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.7;
            margin: 0;
        }

        @media (max-width: 768px) {
            .why-grid {
                grid-template-columns: 1fr;
            }
            .why-card-large {
                grid-column: auto;
            }
        }

        /* Use Cases Section */
        .usecases-section {
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .usecases-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
        }

        .usecase-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.25rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 100px;
            font-size: 0.875rem;
            color: var(--text-secondary);
            transition: all 0.2s ease;
        }

        .usecase-item:hover {
            border-color: var(--accent-green);
            color: var(--text-primary);
        }

        .usecase-icon {
            font-size: 1.125rem;
        }

        /* FAQ Section */
        .faq-section {
            padding: 4rem 2rem;
            max-width: 1000px;
            margin: 0 auto;
        }

        .faq-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .faq-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.2s ease;
        }

        .faq-item:hover {
            border-color: var(--border-hover);
        }

        .faq-item h3 {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .faq-item p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.7;
            margin: 0;
        }

        /* Footer */
        footer {
            padding: 3rem 2rem;
            border-top: 1px solid var(--border-color);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-left {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .footer-logo {
            font-family: 'Space Mono', monospace;
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .footer-logo span {
            color: var(--accent-green);
        }

        .footer-text {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
        }

        .footer-links a {
            font-size: 0.875rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .footer-links a:hover {
            color: var(--accent-green);
        }

        .footer-bottom {
            max-width: 1200px;
            margin: 1.5rem auto 0;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
            text-align: center;
        }

        .footer-bottom p {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Hidden utility */
        .hidden {
            display: none !important;
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 300;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .toast {
            padding: 1rem 1.25rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
            animation: slideIn 0.3s ease;
        }

        .toast.success {
            border-color: rgba(0, 255, 136, 0.3);
        }

        .toast.error {
            border-color: rgba(255, 68, 68, 0.3);
        }

        .toast svg {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .toast.success svg {
            color: var(--accent-green);
        }

        .toast.error svg {
            color: var(--danger);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            nav {
                padding: 1rem;
            }

            .hero {
                padding: 6rem 1rem 3rem;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .hero-description {
                font-size: 1rem;
            }

            .tool-section {
                padding: 1rem;
            }

            .tool-body {
                padding: 1rem;
            }

            .upload-area {
                padding: 2rem 1rem;
            }

            .actions-bar {
                flex-direction: column;
            }

            .actions-left,
            .actions-right {
                width: 100%;
            }

            .actions-left .btn,
            .actions-right .btn {
                flex: 1;
                justify-content: center;
            }
        }
    </style>
</head>
<body class="grid-bg">
    <!-- Navigation -->
    <nav>
        <a href="/" class="logo">RMBG<span>.</span></a>
        <div class="nav-right">
            <div class="nav-badge">
                <span>离线运行中</span>
            </div>
            <a href="/" class="lang-switch" title="Switch to English">
                <span class="lang-current">中</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="2" y1="12" x2="22" y2="12"/>
                    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                </svg>
            </a>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-label">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
            <span>100% 本地处理 · 隐私优先 · 图片不出端</span>
        </div>

        <h1>
            <span>AI 智能抠图</span><br>
            <span class="gradient">免费 & 完全隐私</span>
        </h1>

        <p class="hero-description">
            基于 RMBG-2.0 深度学习模型，完全运行在您的浏览器中。图片永远不会上传到服务器，您的数据完全由您掌控。一键去除背景，秒出透明图。
        </p>

        <div class="hero-features">
            <div class="feature-tag">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                </svg>
                <span>100% 隐私</span>
            </div>
            <div class="feature-tag">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="2" y1="12" x2="22" y2="12"/>
                    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                </svg>
                <span>永久免费</span>
            </div>
            <div class="feature-tag">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                </svg>
                <span>秒级处理</span>
            </div>
            <div class="feature-tag">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="7" height="7"/>
                    <rect x="14" y="3" width="7" height="7"/>
                    <rect x="14" y="14" width="7" height="7"/>
                    <rect x="3" y="14" width="7" height="7"/>
                </svg>
                <span>批量处理</span>
            </div>
            <div class="feature-tag">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/>
                    <rect x="9" y="9" width="6" height="6"/>
                    <line x1="9" y1="1" x2="9" y2="4"/>
                    <line x1="15" y1="1" x2="15" y2="4"/>
                    <line x1="9" y1="20" x2="9" y2="23"/>
                    <line x1="15" y1="20" x2="15" y2="23"/>
                    <line x1="20" y1="9" x2="23" y2="9"/>
                    <line x1="20" y1="14" x2="23" y2="14"/>
                    <line x1="1" y1="9" x2="4" y2="9"/>
                    <line x1="1" y1="14" x2="4" y2="14"/>
                </svg>
                <span>WebGPU 加速</span>
            </div>
        </div>
    </section>

    <!-- Tool Section -->
    <section class="tool-section">
        <div class="tool-container">
            <div class="tool-header">
                <div class="tool-title">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="12 2 2 7 12 12 22 7 12 2"/>
                        <polyline points="2 17 12 22 22 17"/>
                        <polyline points="2 12 12 17 22 12"/>
                    </svg>
                    <span>RMBG Processor</span>
                </div>
                <div class="model-info">
                    <span class="model-badge">RMBG-2.0</span>
                    <span class="backend-badge webgpu" id="backend-badge">检测中...</span>
                </div>
            </div>

            <div class="tool-body">
                <!-- Upload Area (Initial State) -->
                <div class="upload-area" id="upload-area">
                    <div class="upload-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                    </div>
                    <h3>拖放图片到这里</h3>
                    <p>或点击选择文件</p>
                    <span class="upload-hint">支持 JPG、PNG、WebP 格式，支持多文件批量上传</span>
                    <input type="file" class="file-input" id="file-input" accept="image/*" multiple>
                </div>

                <!-- Processing Area -->
                <div class="processing-area" id="processing-area">
                    <div class="image-grid">
                        <div class="image-panel">
                            <div class="image-panel-header">
                                <span class="image-panel-title">原图</span>
                            </div>
                            <div class="image-panel-body">
                                <img id="original-image" src="" alt="Original">
                            </div>
                        </div>
                        <div class="image-panel">
                            <div class="image-panel-header">
                                <span class="image-panel-title">处理结果</span>
                            </div>
                            <div class="image-panel-body checkerboard">
                                <img id="result-image" alt="Result" style="display: none;">
                                <div class="processing-spinner" id="processing-spinner">
                                    <div class="spinner"></div>
                                    <p>AI 推理中...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="actions-bar">
                        <div class="actions-left">
                            <button class="btn btn-secondary" id="btn-new">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="12" y1="5" x2="12" y2="19"/>
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                <span>新图片</span>
                            </button>
                            <button class="btn btn-secondary" id="btn-batch">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="3" width="7" height="7"/>
                                    <rect x="14" y="3" width="7" height="7"/>
                                    <rect x="14" y="14" width="7" height="7"/>
                                    <rect x="3" y="14" width="7" height="7"/>
                                </svg>
                                <span>批量模式</span>
                            </button>
                        </div>
                        <div class="actions-right">
                            <button class="btn btn-success" id="btn-download" disabled>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7 10 12 15 17 10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                                <span>下载 PNG</span>
                            </button>
                        </div>
                    </div>

                    <!-- Batch Queue -->
                    <div class="batch-section hidden" id="batch-section">
                        <div class="batch-header">
                            <span class="batch-title"><span>批量队列</span> (<span id="batch-count">0</span> 张)</span>
                            <div class="batch-actions">
                                <button class="btn btn-secondary btn-small" id="btn-add-batch">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <line x1="12" y1="5" x2="12" y2="19"/>
                                        <line x1="5" y1="12" x2="19" y2="12"/>
                                    </svg>
                                    <span>添加</span>
                                </button>
                                <button class="btn btn-success btn-small" id="btn-process-batch">
                                    处理全部
                                </button>
                                <button class="btn btn-success btn-small" id="btn-download-batch" disabled>
                                    下载全部
                                </button>
                            </div>
                        </div>
                        <div class="batch-queue" id="batch-queue"></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section" id="features">
        <div class="section-header">
            <h2>强大的 AI 智能抠图功能</h2>
            <p>基于前沿 AI 技术，满足您所有的抠图去背景需求</p>
        </div>

        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    </svg>
                </div>
                <h3>100% 隐私安全</h3>
                <p>所有处理都在您的设备上完成，图片永远不会离开浏览器。无需担心数据泄露。</p>
            </div>

            <div class="feature-card">
                <div class="feature-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="2" y1="12" x2="22" y2="12"/>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                    </svg>
                </div>
                <h3>永久免费，无限使用</h3>
                <p>没有使用次数限制，没有水印，无需注册。完全免费，永久可用。</p>
            </div>

            <div class="feature-card">
                <div class="feature-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                    </svg>
                </div>
                <h3>即时处理</h3>
                <p>WebGPU 加速让处理速度提升数倍。几秒内完成抠图，无需等待服务器响应。</p>
            </div>

            <div class="feature-card">
                <div class="feature-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="4" y="4" width="16" height="16" rx="2" ry="2"/>
                        <rect x="9" y="9" width="6" height="6"/>
                        <line x1="9" y1="1" x2="9" y2="4"/>
                        <line x1="15" y1="1" x2="15" y2="4"/>
                        <line x1="9" y1="20" x2="9" y2="23"/>
                        <line x1="15" y1="20" x2="15" y2="23"/>
                        <line x1="20" y1="9" x2="23" y2="9"/>
                        <line x1="20" y1="14" x2="23" y2="14"/>
                        <line x1="1" y1="9" x2="4" y2="9"/>
                        <line x1="1" y1="14" x2="4" y2="14"/>
                    </svg>
                </div>
                <h3>先进 AI 模型</h3>
                <p>采用 RMBG-2.0 深度学习模型，精准识别前景主体，边缘处理细腻自然，发丝级别精度。</p>
            </div>

            <div class="feature-card">
                <div class="feature-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="7" height="7"/>
                        <rect x="14" y="3" width="7" height="7"/>
                        <rect x="14" y="14" width="7" height="7"/>
                        <rect x="3" y="14" width="7" height="7"/>
                    </svg>
                </div>
                <h3>批量处理</h3>
                <p>支持一次性处理多张图片，适合电商产品图、证件照批量处理等场景。</p>
            </div>

            <div class="feature-card">
                <div class="feature-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
                        <line x1="8" y1="21" x2="16" y2="21"/>
                        <line x1="12" y1="17" x2="12" y2="21"/>
                    </svg>
                </div>
                <h3>离线可用</h3>
                <p>模型加载后可完全离线使用，无需网络连接也能处理图片，随时随地保护隐私。</p>
            </div>
        </div>
    </section>

    <!-- Why Choose Section -->
    <section class="why-section" id="why-choose">
        <div class="section-header">
            <h2>为什么选择 RMBG？</h2>
            <p>网络上最注重隐私的 AI 抠图工具</p>
        </div>

        <div class="why-grid">
            <div class="why-card why-card-large">
                <div class="why-card-content">
                    <div class="why-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                    </div>
                    <h3>数据完全由您掌控</h3>
                    <p>与其他将图片上传到服务器的抠图工具不同，RMBG 在本地处理一切。您的敏感图片、个人照片和机密文档永远不会离开浏览器。即使我们想看也看不到您的图片。/p>
                </div>
            </div>

            <div class="why-card">
                <div class="why-card-content">
                    <div class="why-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="1" x2="12" y2="23"/>
                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                        </svg>
                    </div>
                    <h3>零成本，零套路</h3>
                    <p>没有订阅费，没有积分制，没有高级版。RMBG 100% 免费，因为处理在您的设备上进行，不在我们的服务器上。</p>
                </div>
            </div>

            <div class="why-card">
                <div class="why-card-content">
                    <div class="why-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                    </div>
                    <h3>专业级质量</h3>
                    <p>RMBG-2.0 模型提供媲美付费服务的效果。边缘干净，检测准确，抠图自然。</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Use Cases Section -->
    <section class="usecases-section" id="use-cases">
        <div class="section-header">
            <h2>适用于各种场景</h2>
            <p>移除任何类型图片的背景</p>
        </div>

        <div class="usecases-grid">
            <div class="usecase-item">
                <span class="usecase-icon">🛍️</span>
                <span>电商产品图</span>
            </div>
            <div class="usecase-item">
                <span class="usecase-icon">👤</span>
                <span>人像照片</span>
            </div>
            <div class="usecase-item">
                <span class="usecase-icon">📸</span>
                <span>证件照 & 护照照</span>
            </div>
            <div class="usecase-item">
                <span class="usecase-icon">🎨</span>
                <span>平面设计</span>
            </div>
            <div class="usecase-item">
                <span class="usecase-icon">📱</span>
                <span>社交媒体内容</span>
            </div>
            <div class="usecase-item">
                <span class="usecase-icon">🏢</span>
                <span>营销素材</span>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq-section" id="faq">
        <div class="section-header">
            <h2>常见问题</h2>
            <p>关于我们 AI 抠图工具的一切</p>
        </div>

        <div class="faq-grid">
            <div class="faq-item">
                <h3>RMBG 真的免费吗？</h3>
                <p>是的，RMBG 100% 免费，没有任何限制。由于所有处理都在您的设备上进行，我们没有服务器成本需要覆盖。您可以无限制地抠图，没有任何费用或水印。/p>
            </div>

            <div class="faq-item">
                <h3>RMBG 如何保护我的隐私？</h3>
                <p>RMBG 完全在您的浏览器中使用 WebGPU/WebAssembly 技术运行。您的图片永远不会上传到任何服务器。AI 模型下载一次后在您的设备上本地运行。我们无法访问您的任何照片。</p>
            </div>

            <div class="faq-item">
                <h3>支持哪些图片格式？</h3>
                <p>RMBG 支持所有常见图片格式，包括 JPG、PNG 和 WebP。输出始终为带透明背景的 PNG 格式，以保持最高质量。</p>
            </div>

            <div class="faq-item">
                <h3>为什么首次使用需要更长时间？</h3>
                <p>首次使用时，RMBG 会将 AI 模型（约 234MB）下载到浏览器缓存中。之后，模型会即时从缓存加载，借助 WebGPU 加速，处理几乎是瞬时完成的。</p>
            </div>

            <div class="faq-item">
                <h3>RMBG 在移动设备上能用吗？</h3>
                <p>可以！RMBG 可在任何现代浏览器上运行，包括移动设备。但为了获得最佳性能，我们建议使用支持 WebGPU 的设备（桌面或 Android 上的 Chrome）。该工具会在旧设备上自动切换到 WebAssembly。</p>
            </div>

            <div class="faq-item">
                <h3>我可以离线使用 RMBG 吗？</h3>
                <p>可以！一旦 AI 模型缓存到浏览器中，RMBG 就可以完全离线工作。这使其非常适合在网络连接不佳的地区使用，或者当您需要最大程度保护隐私时。</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-left">
                <span class="footer-logo">RMBG<span>.</span></span>
                <span class="footer-text">免费 AI 抠图工具 · 100% 隐私</span>
            </div>
            <div class="footer-links">
                <a href="#features">功能特性</a>
                <a href="#faq">常见问题</a>
                <a href="https://huggingface.co/briaai/RMBG-2.0" target="_blank">模型来源</a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>RMBG - 隐私优先的 AI 抠图工具。您的图片永远不会离开浏览器。</p>
        </div>
    </footer>

    <!-- Privacy Consent Modal -->
    <div class="consent-overlay" id="consent-overlay">
        <div class="consent-modal">
            <div class="consent-header">
                <div class="consent-header-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                    </svg>
                </div>
                <div class="consent-header-text">
                    <h3>首次使用 · 加载 AI 模型</h3>
                    <p>模型仅需加载一次，后续访问自动缓存</p>
                </div>
            </div>

            <div class="consent-body">
                <div class="consent-feature">
                    <div class="consent-feature-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                    </div>
                    <div>
                        <h4>隐私优先</h4>
                        <p>您的图片永远不会离开浏览器。所有 AI 推理都在您的设备上本地完成，我们无法访问您处理的任何内容。</p>
                    </div>
                </div>

                <div class="consent-feature">
                    <div class="consent-feature-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                    </div>
                    <div>
                        <h4>一次下载，永久使用</h4>
                        <p>AI 模型（约 234MB）将下载到您的浏览器缓存中。之后的每次使用都是即时的，无需重复下载。</p>
                    </div>
                </div>

                <div class="consent-feature">
                    <div class="consent-feature-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
                        </svg>
                    </div>
                    <div>
                        <h4>硬件加速</h4>
                        <p>自动检测 WebGPU 支持以获得更快的处理速度，不支持时自动切换到 WebAssembly。</p>
                    </div>
                </div>
            </div>

            <div class="consent-footer">
                <button class="btn-primary" id="btn-load-model">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                    <span>加载模型并开始使用</span>
                </button>
                <p class="consent-note">点击即表示您理解这是一个完全本地化的工具，您的数据由您完全掌控</p>
            </div>
        </div>
    </div>

    <!-- Model Loading Overlay -->
    <div class="consent-overlay hidden" id="loading-overlay">
        <div class="consent-modal" style="max-width: 420px;">
            <div class="model-loader">
                <div class="model-loader-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="12 2 2 7 12 12 22 7 12 2"/>
                        <polyline points="2 17 12 22 22 17"/>
                        <polyline points="2 12 12 17 22 12"/>
                    </svg>
                </div>
                <h3>正在加载 AI 模型</h3>
                <p id="loading-status">初始化推理引擎...</p>
                <div class="progress-bar">
                    <div class="progress-bar-fill" id="progress-fill" style="width: 0%"></div>
                </div>
                <span class="progress-text" id="progress-text">0%</span>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- ONNX Runtime Web with WebGPU support -->
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.21.0/dist/ort.webgpu.min.js"></script>

    <script>
        // ============================================
        // RMBG - Browser-based Background Removal
        // Using RMBG-2.0 ONNX Model with WebGPU/WASM
        // ============================================

        const CONFIG = {
            // RMBG-1.4 ONNX model
            MODEL_URL: '../model/model.onnx',
            INPUT_SIZE: 1024,
            CACHE_KEY: 'rmbg-model-loaded',
        };

        // State
        let session = null;
        let isModelLoaded = false;
        let currentBackend = 'unknown';
        let batchMode = false;
        let batchQueue = [];
        let processedResults = new Map();

        // DOM Elements
        const elements = {
            consentOverlay: document.getElementById('consent-overlay'),
            loadingOverlay: document.getElementById('loading-overlay'),
            btnLoadModel: document.getElementById('btn-load-model'),
            loadingStatus: document.getElementById('loading-status'),
            progressFill: document.getElementById('progress-fill'),
            progressText: document.getElementById('progress-text'),
            backendBadge: document.getElementById('backend-badge'),
            uploadArea: document.getElementById('upload-area'),
            fileInput: document.getElementById('file-input'),
            processingArea: document.getElementById('processing-area'),
            originalImage: document.getElementById('original-image'),
            resultImage: document.getElementById('result-image'),
            processingSpinner: document.getElementById('processing-spinner'),
            btnNew: document.getElementById('btn-new'),
            btnBatch: document.getElementById('btn-batch'),
            btnDownload: document.getElementById('btn-download'),
            batchSection: document.getElementById('batch-section'),
            batchQueue: document.getElementById('batch-queue'),
            batchCount: document.getElementById('batch-count'),
            btnAddBatch: document.getElementById('btn-add-batch'),
            btnProcessBatch: document.getElementById('btn-process-batch'),
            btnDownloadBatch: document.getElementById('btn-download-batch'),
            toastContainer: document.getElementById('toast-container'),
        };

        // ============================================
        // Utility Functions
        // ============================================

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    ${type === 'success'
                        ? '<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>'
                        : '<circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>'}
                </svg>
                <span>${message}</span>
            `;
            elements.toastContainer.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        function updateProgress(percent, status) {
            elements.progressFill.style.width = `${percent}%`;
            elements.progressText.textContent = `${Math.round(percent)}%`;
            if (status) {
                elements.loadingStatus.textContent = status;
            }
        }

        // ============================================
        // Backend Detection
        // ============================================

        async function detectBackend() {
            // Check WebGPU support
            if (navigator.gpu) {
                try {
                    const adapter = await navigator.gpu.requestAdapter();
                    if (adapter) {
                        const device = await adapter.requestDevice();
                        if (device) {
                            currentBackend = 'webgpu';
                            elements.backendBadge.textContent = 'WebGPU';
                            elements.backendBadge.className = 'backend-badge webgpu';
                            console.log('WebGPU available, using GPU acceleration');
                            return 'webgpu';
                        }
                    }
                } catch (e) {
                    console.log('WebGPU not available:', e);
                }
            }

            // Fallback to WASM
            currentBackend = 'wasm';
            elements.backendBadge.textContent = 'WASM';
            elements.backendBadge.className = 'backend-badge wasm';
            console.log('Using WASM backend (CPU)');
            return 'wasm';
        }

        // ============================================
        // Model Loading
        // ============================================

        async function loadModel() {
            try {
                elements.consentOverlay.classList.add('hidden');
                elements.loadingOverlay.classList.remove('hidden');

                updateProgress(5, '检测硬件加速支持...');
                const backend = await detectBackend();

                updateProgress(10, `使用 ${backend.toUpperCase()} 后端...`);

                // Configure ONNX Runtime with WebGPU priority, WASM fallback
                let executionProviders = ['wasm']; // Default fallback

                if (backend === 'webgpu') {
                    executionProviders = ['webgpu', 'wasm'];
                }

                const options = {
                    executionProviders,
                    graphOptimizationLevel: 'all',
                };

                // WASM config: check if cross-origin isolated for multi-threading
                if (crossOriginIsolated) {
                    ort.env.wasm.numThreads = navigator.hardwareConcurrency || 4;
                } else {
                    ort.env.wasm.numThreads = 1;
                }
                ort.env.wasm.simd = true;

                updateProgress(15, '检查模型缓存...');

                // Try to load from Cache API first
                const CACHE_NAME = 'rmbg-model-cache-v1';
                let modelBuffer;

                try {
                    const cache = await caches.open(CACHE_NAME);
                    const cachedResponse = await cache.match(CONFIG.MODEL_URL);

                    if (cachedResponse) {
                        updateProgress(20, '从缓存加载模型...');
                        const arrayBuffer = await cachedResponse.arrayBuffer();
                        modelBuffer = new Uint8Array(arrayBuffer);
                        updateProgress(85, '初始化推理会话...');
                        console.log('Model loaded from cache');
                    } else {
                        // Download and cache
                        updateProgress(15, '首次下载 AI 模型中...');

                        const response = await fetch(CONFIG.MODEL_URL);
                        const contentLength = response.headers.get('content-length');
                        const total = contentLength ? parseInt(contentLength, 10) : 0;

                        if (total === 0) {
                            // No content-length, direct download
                            const arrayBuffer = await response.arrayBuffer();
                            modelBuffer = new Uint8Array(arrayBuffer);
                        } else {
                            let loaded = 0;
                            const reader = response.body.getReader();
                            const chunks = [];

                            while (true) {
                                const { done, value } = await reader.read();
                                if (done) break;

                                chunks.push(value);
                                loaded += value.length;

                                const percent = 15 + (loaded / total) * 70;
                                updateProgress(percent, `下载模型中... ${(loaded / 1024 / 1024).toFixed(1)}MB / ${(total / 1024 / 1024).toFixed(1)}MB`);
                            }

                            // Combine chunks into ArrayBuffer
                            modelBuffer = new Uint8Array(loaded);
                            let position = 0;
                            for (const chunk of chunks) {
                                modelBuffer.set(chunk, position);
                                position += chunk.length;
                            }
                        }

                        // Cache the model for future use
                        updateProgress(85, '缓存模型到浏览器...');
                        const cacheResponse = new Response(modelBuffer.buffer, {
                            headers: { 'Content-Type': 'application/octet-stream' }
                        });
                        await cache.put(CONFIG.MODEL_URL, cacheResponse);
                        console.log('Model cached for future use');
                    }
                } catch (cacheError) {
                    console.warn('Cache API not available, downloading directly:', cacheError);
                    // Fallback: direct download without caching
                    const response = await fetch(CONFIG.MODEL_URL);
                    const arrayBuffer = await response.arrayBuffer();
                    modelBuffer = new Uint8Array(arrayBuffer);
                }

                updateProgress(85, '初始化推理会话...');

                updateProgress(90, '编译模型图...');

                // Create inference session
                try {
                    console.log('Model buffer size:', modelBuffer.byteLength);
                    console.log('Execution providers:', options.executionProviders);
                    session = await ort.InferenceSession.create(modelBuffer.buffer, options);
                    console.log('Session created successfully');
                    console.log('Input names:', session.inputNames);
                    console.log('Output names:', session.outputNames);
                } catch (sessionError) {
                    console.error('Session creation failed:', sessionError);
                    // Try WASM only as fallback
                    console.log('Retrying with WASM only...');
                    options.executionProviders = ['wasm'];
                    session = await ort.InferenceSession.create(modelBuffer.buffer, options);
                    currentBackend = 'wasm';
                    elements.backendBadge.textContent = 'WASM';
                    elements.backendBadge.className = 'backend-badge wasm';
                }

                updateProgress(100, '加载完成！');
                isModelLoaded = true;

                // Save to cache indicator
                localStorage.setItem(CONFIG.CACHE_KEY, 'true');

                setTimeout(() => {
                    elements.loadingOverlay.classList.add('hidden');
                    showToast('模型加载成功，可以开始使用了！');
                }, 500);

            } catch (error) {
                console.error('Model loading error:', error);
                updateProgress(0, '加载失败');
                showToast('模型加载失败：' + error.message, 'error');

                setTimeout(() => {
                    elements.loadingOverlay.classList.add('hidden');
                    elements.consentOverlay.classList.remove('hidden');
                }, 2000);
            }
        }

        // ============================================
        // Image Processing
        // ============================================

        async function preprocessImage(imageElement) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d', { willReadFrequently: true });

            canvas.width = CONFIG.INPUT_SIZE;
            canvas.height = CONFIG.INPUT_SIZE;

            // 直接拉伸到 1024x1024（与参考实现一致）
            ctx.drawImage(imageElement, 0, 0, CONFIG.INPUT_SIZE, CONFIG.INPUT_SIZE);

            const imageData = ctx.getImageData(0, 0, CONFIG.INPUT_SIZE, CONFIG.INPUT_SIZE);
            const { data } = imageData;

            const area = CONFIG.INPUT_SIZE * CONFIG.INPUT_SIZE;
            const float32Data = new Float32Array(3 * area);

            // normalize: rescale 1/255 + mean=0.5 std=1
            for (let i = 0; i < area; i++) {
                const r = data[i * 4] / 255;
                const g = data[i * 4 + 1] / 255;
                const b = data[i * 4 + 2] / 255;

                float32Data[i] = r - 0.5;
                float32Data[i + area] = g - 0.5;
                float32Data[i + area * 2] = b - 0.5;
            }

            return {
                tensor: new ort.Tensor('float32', float32Data, [1, 3, CONFIG.INPUT_SIZE, CONFIG.INPUT_SIZE]),
            };
        }

        async function removeBackground(imageElement) {
            if (!session) {
                throw new Error('Model not loaded');
            }

            const { tensor } = await preprocessImage(imageElement);

            // Run inference
            const inputName = session.inputNames[0];
            const feeds = { [inputName]: tensor };
            const results = await session.run(feeds);

            // Get mask output
            const outputName = session.outputNames[0];
            const maskTensor = results[outputName];
            const maskData = maskTensor.data;
            const dims = maskTensor.dims;

            console.log('Output shape:', dims);

            // Get mask dimensions
            let mh, mw;
            if (dims.length === 4) {
                mh = dims[2];
                mw = dims[3];
            } else {
                mh = dims[1];
                mw = dims[2];
            }

            // Create mask canvas
            const maskCanvas = document.createElement('canvas');
            maskCanvas.width = mw;
            maskCanvas.height = mh;
            const mctx = maskCanvas.getContext('2d');
            const maskImg = mctx.createImageData(mw, mh);

            for (let i = 0; i < mw * mh; i++) {
                let a = maskData[i];
                // 部分导出是 logits，简单 sigmoid 兜底
                if (a < 0 || a > 1) a = 1 / (1 + Math.exp(-a));
                a = Math.max(0, Math.min(1, a));
                const v = (a * 255) | 0;
                maskImg.data[i * 4] = v;
                maskImg.data[i * 4 + 1] = v;
                maskImg.data[i * 4 + 2] = v;
                maskImg.data[i * 4 + 3] = 255;
            }
            mctx.putImageData(maskImg, 0, 0);

            // Create output canvas at original image size
            const ow = imageElement.naturalWidth || imageElement.width;
            const oh = imageElement.naturalHeight || imageElement.height;
            const outCanvas = document.createElement('canvas');
            outCanvas.width = ow;
            outCanvas.height = oh;
            const octx = outCanvas.getContext('2d', { willReadFrequently: true });
            octx.clearRect(0, 0, ow, oh);
            octx.drawImage(imageElement, 0, 0);

            // Alpha canvas (resize mask back to original size)
            const alphaCanvas = document.createElement('canvas');
            alphaCanvas.width = ow;
            alphaCanvas.height = oh;
            const actx = alphaCanvas.getContext('2d');
            // 轻微羽化减少毛边
            actx.filter = 'blur(1px)';
            actx.drawImage(maskCanvas, 0, 0, ow, oh);

            const outImgData = octx.getImageData(0, 0, ow, oh);
            const alphaData = actx.getImageData(0, 0, ow, oh).data;

            for (let i = 0; i < ow * oh; i++) {
                outImgData.data[i * 4 + 3] = alphaData[i * 4]; // 用 R 做 alpha
            }
            octx.putImageData(outImgData, 0, 0);

            return outCanvas.toDataURL('image/png');
        }

        // ============================================
        // File Handling
        // ============================================

        async function handleFiles(files) {
            if (!isModelLoaded) {
                showToast('请先加载模型', 'error');
                return;
            }

            const imageFiles = Array.from(files).filter(f => f.type.startsWith('image/'));

            if (imageFiles.length === 0) {
                showToast('请选择图片文件', 'error');
                return;
            }

            if (batchMode && imageFiles.length > 1) {
                // Add to batch queue
                for (const file of imageFiles) {
                    const url = URL.createObjectURL(file);
                    batchQueue.push({ file, url, processed: false });
                }
                updateBatchUI();
            } else {
                // Process single image
                const file = imageFiles[0];
                await processSingleImage(file);
            }
        }

        async function processSingleImage(file) {
            elements.uploadArea.classList.add('hidden');
            elements.processingArea.classList.add('active');
            elements.processingSpinner.classList.remove('hidden');
            elements.btnDownload.disabled = true;

            const url = URL.createObjectURL(file);
            elements.originalImage.src = url;

            const img = new Image();
            img.onload = async () => {
                try {
                    const resultUrl = await removeBackground(img);
                    elements.resultImage.src = resultUrl;
                    elements.resultImage.style.display = 'block';
                    elements.processingSpinner.classList.add('hidden');
                    elements.btnDownload.disabled = false;
                    showToast('处理完成！');
                } catch (error) {
                    console.error('Processing error:', error);
                    showToast('处理失败：' + error.message, 'error');
                    elements.processingSpinner.classList.add('hidden');
                }
            };
            img.src = url;
        }

        function updateBatchUI() {
            elements.batchCount.textContent = batchQueue.length;
            elements.batchQueue.innerHTML = '';

            batchQueue.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'batch-item';
                div.innerHTML = `
                    <img src="${item.url}" alt="Batch item ${index + 1}">
                    ${item.processed ? `
                        <div class="batch-item-overlay done">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="20 6 9 17 4 12"/>
                            </svg>
                        </div>
                    ` : ''}
                    <button class="batch-item-remove" data-index="${index}">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="14" height="14">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                `;
                elements.batchQueue.appendChild(div);
            });

            // Enable download all if all processed
            const allProcessed = batchQueue.length > 0 && batchQueue.every(item => item.processed);
            elements.btnDownloadBatch.disabled = !allProcessed;
        }

        async function processBatch() {
            if (!isModelLoaded || batchQueue.length === 0) return;

            elements.btnProcessBatch.disabled = true;
            elements.btnProcessBatch.textContent = '处理中...';

            for (let i = 0; i < batchQueue.length; i++) {
                const item = batchQueue[i];
                if (item.processed) continue;

                try {
                    const img = new Image();
                    await new Promise((resolve, reject) => {
                        img.onload = resolve;
                        img.onerror = reject;
                        img.src = item.url;
                    });

                    const resultUrl = await removeBackground(img);
                    processedResults.set(item.url, resultUrl);
                    item.processed = true;
                    updateBatchUI();
                } catch (error) {
                    console.error(`Failed to process image ${i + 1}:`, error);
                }
            }

            elements.btnProcessBatch.disabled = false;
            elements.btnProcessBatch.textContent = '处理全部';
            showToast(`批量处理完成！ ${batchQueue.filter(i => i.processed).length} 张图片已处理`);
        }

        async function downloadBatch() {
            // Download all processed images as individual files
            for (let i = 0; i < batchQueue.length; i++) {
                const item = batchQueue[i];
                const resultUrl = processedResults.get(item.url);
                if (resultUrl) {
                    const link = document.createElement('a');
                    link.href = resultUrl;
                    link.download = `rmbg-${i + 1}.png`;
                    link.click();
                    await new Promise(r => setTimeout(r, 200)); // Small delay between downloads
                }
            }
        }

        // ============================================
        // Event Listeners
        // ============================================

        // Load model button
        elements.btnLoadModel.addEventListener('click', loadModel);

        // File input
        elements.fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });

        // Upload area click
        elements.uploadArea.addEventListener('click', () => {
            if (isModelLoaded) {
                elements.fileInput.click();
            } else {
                showToast('请先加载模型', 'error');
            }
        });

        // Drag and drop
        elements.uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.add('dragover');
        });

        elements.uploadArea.addEventListener('dragleave', () => {
            elements.uploadArea.classList.remove('dragover');
        });

        elements.uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        });

        // New image button
        elements.btnNew.addEventListener('click', () => {
            elements.processingArea.classList.remove('active');
            elements.uploadArea.classList.remove('hidden');
            elements.fileInput.value = '';
            elements.originalImage.src = '';
            elements.resultImage.src = '';
            elements.resultImage.style.display = 'none';
        });

        // Batch mode button
        elements.btnBatch.addEventListener('click', () => {
            batchMode = !batchMode;
            elements.batchSection.classList.toggle('hidden', !batchMode);
            elements.btnBatch.classList.toggle('btn-success', batchMode);
            elements.btnBatch.classList.toggle('btn-secondary', !batchMode);

            if (!batchMode) {
                batchQueue = [];
                processedResults.clear();
                updateBatchUI();
            }
        });

        // Download button
        elements.btnDownload.addEventListener('click', () => {
            const link = document.createElement('a');
            link.href = elements.resultImage.src;
            link.download = 'rmbg-result.png';
            link.click();
        });

        // Batch controls
        elements.btnAddBatch.addEventListener('click', () => {
            elements.fileInput.click();
        });

        elements.btnProcessBatch.addEventListener('click', processBatch);
        elements.btnDownloadBatch.addEventListener('click', downloadBatch);

        // Remove batch item
        elements.batchQueue.addEventListener('click', (e) => {
            const removeBtn = e.target.closest('.batch-item-remove');
            if (removeBtn) {
                const index = parseInt(removeBtn.dataset.index);
                const item = batchQueue[index];
                URL.revokeObjectURL(item.url);
                processedResults.delete(item.url);
                batchQueue.splice(index, 1);
                updateBatchUI();
            }
        });

        // ============================================
        // Initialization
        // ============================================

        async function init() {
            // Detect backend on load
            await detectBackend();

            // Check if model is cached, auto-load if yes
            const CACHE_NAME = 'rmbg-model-cache-v1';
            try {
                const cache = await caches.open(CACHE_NAME);
                const cachedResponse = await cache.match(CONFIG.MODEL_URL);

                if (cachedResponse) {
                    // Model is cached, skip consent and auto-load
                    console.log('Model found in cache, auto-loading...');
                    elements.consentOverlay.classList.add('hidden');
                    await loadModel();
                }
            } catch (e) {
                console.log('Cache check failed:', e);
            }
        }

        init();
    </script>
</body>
</html>
